{"ast":null,"code":"import { __awaiter as i } from \"../../../../node_modules/.pnpm/@rollup_plugin-typescript@11.1.6_rollup@4.24.4_tslib@2.6.3_typescript@4.9.5/node_modules/tslib/tslib.es6.js\";\nimport { sendMessageToParent as e, sendAndHandleStatusAndReason as n, callFunctionInHostAndHandleResponse as t, initializeCommunication as o } from \"./communication.js\";\nimport { errorLibraryNotInitialized as r, defaultSDKVersionForCompatCheck as s } from \"./constants.js\";\nimport { GlobalVars as l } from \"./globalVars.js\";\nimport { registerOnThemeChangeHandler as a, initializeHandlers as p } from \"./handlers.js\";\nimport { ensureInitializeCalled as u, ensureInitialized as m, processAdditionalValidOrigins as c } from \"./internalAPIs.js\";\nimport { getLogger as f } from \"./telemetry.js\";\nimport { isNullOrUndefined as d } from \"./typeCheckUtilities.js\";\nimport { inServerSideRenderingEnvironment as g, runWithTimeout as h, compareSDKVersions as S } from \"./utils.js\";\nimport { Messages as j } from \"../public/app/app.js\";\nimport { FrameContexts as v } from \"../public/constants.js\";\nimport { initialize as w } from \"../public/dialog/dialog.js\";\nimport { initialize as y } from \"../public/menus.js\";\nimport { runtime as z, applyRuntimeConfig as b, generateVersionBasedTeamsRuntimeConfig as P, mapTeamsVersionToSupportedCapabilities as C, versionAndPlatformAgnosticTeamsRuntimeConfig as x } from \"../public/runtime.js\";\nimport { version as D } from \"../public/version.js\";\nimport { SimpleTypeResponseHandler as E } from \"./responseHandler.js\";\nimport { initialize as V } from \"../public/pages/config.js\";\nconst K = f(\"app\");\nfunction _(i, e) {\n  if (g()) {\n    return K.extend(\"initialize\")(\"window object undefined at initialization\"), Promise.resolve();\n  }\n  return h(() => function (i, e) {\n    return new Promise(n => {\n      l.initializeCalled || (l.initializeCalled = !0, p(), l.initializePromise = o(e, i).then(_ref => {\n        let {\n          context: i,\n          clientType: e,\n          runtimeConfig: n,\n          clientSupportedSDKVersion: t = s\n        } = _ref;\n        l.frameContext = i, l.hostClientType = e, l.clientSupportedSDKVersion = t;\n        try {\n          H(\"Parsing %s\", n);\n          const i = JSON.parse(n);\n          if (H(\"Checking if %o is a valid runtime object\", null != i ? i : \"null\"), !i || !i.apiVersion) throw new Error(\"Received runtime config is invalid\");\n          n && b(i);\n        } catch (i) {\n          if (!(i instanceof SyntaxError)) throw i;\n          try {\n            H(\"Attempting to parse %s as an SDK version\", n), isNaN(S(n, s)) || (l.clientSupportedSDKVersion = n);\n            const i = JSON.parse(t);\n            if (H(\"givenRuntimeConfig parsed to %o\", null != i ? i : \"null\"), !i) throw new Error(\"givenRuntimeConfig string was successfully parsed. However, it parsed to value of null\");\n            b(i);\n          } catch (i) {\n            if (!(i instanceof SyntaxError)) throw i;\n            b(P(l.clientSupportedSDKVersion, x, C));\n          }\n        }\n        l.initializeCompleted = !0;\n      }), y(), V(), w()), Array.isArray(e) && c(e), void 0 !== l.initializePromise ? n(l.initializePromise) : H(\"GlobalVars.initializePromise is unexpectedly undefined\");\n    });\n  }(i, e), 6e4, new Error(\"SDK initialization timed out.\"));\n}\nfunction k(i) {\n  e(i, j.AppLoaded, [D]);\n}\nfunction A(i, n) {\n  e(i, j.ExpectedFailure, [n.reason, n.message]);\n}\nfunction F(i, n) {\n  e(i, j.Failure, [n.reason, n.message]);\n}\nfunction N(e) {\n  return i(this, void 0, void 0, function* () {\n    if (l.initializeCompleted) return R(e);\n    if (!l.initializePromise) throw new Error(r);\n    return l.initializePromise.then(() => R(e));\n  });\n}\nfunction R(n) {\n  return i(this, void 0, void 0, function* () {\n    return m(z) && (null === (i = z.supports.app) || void 0 === i ? void 0 : i.notifySuccessResponse) ? t(j.Success, [D], new E(), n).then(() => ({\n      hasFinishedSuccessfully: !0\n    })) : (e(n, j.Success, [D]), {\n      hasFinishedSuccessfully: \"unknown\"\n    });\n    var i;\n  });\n}\nconst H = K.extend(\"initializeHelper\");\nfunction J(i, e) {\n  !d(e) && u(), a(i, e);\n}\nfunction L(i, e) {\n  return new Promise(t => {\n    m(z, v.content, v.sidePanel, v.settings, v.task, v.stage, v.meetingStage), t(n(i, \"executeDeepLink\", e));\n  });\n}\nexport { _ as appInitializeHelper, R as callNotifySuccessInHost, k as notifyAppLoadedHelper, A as notifyExpectedFailureHelper, F as notifyFailureHelper, N as notifySuccessHelper, L as openLinkHelper, J as registerOnThemeChangeHandlerHelper };","map":{"version":3,"names":["__awaiter","i","sendMessageToParent","e","sendAndHandleStatusAndReason","n","callFunctionInHostAndHandleResponse","t","initializeCommunication","o","errorLibraryNotInitialized","r","defaultSDKVersionForCompatCheck","s","GlobalVars","l","registerOnThemeChangeHandler","a","initializeHandlers","p","ensureInitializeCalled","u","ensureInitialized","m","processAdditionalValidOrigins","c","getLogger","f","isNullOrUndefined","d","inServerSideRenderingEnvironment","g","runWithTimeout","h","compareSDKVersions","S","Messages","j","FrameContexts","v","initialize","w","y","runtime","z","applyRuntimeConfig","b","generateVersionBasedTeamsRuntimeConfig","P","mapTeamsVersionToSupportedCapabilities","C","versionAndPlatformAgnosticTeamsRuntimeConfig","x","version","D","SimpleTypeResponseHandler","E","V","K","_","extend","Promise","resolve","initializeCalled","initializePromise","then","_ref","context","clientType","runtimeConfig","clientSupportedSDKVersion","frameContext","hostClientType","H","JSON","parse","apiVersion","Error","SyntaxError","isNaN","initializeCompleted","Array","isArray","k","AppLoaded","A","ExpectedFailure","reason","message","F","Failure","N","R","supports","app","notifySuccessResponse","Success","hasFinishedSuccessfully","J","L","content","sidePanel","settings","task","stage","meetingStage","appInitializeHelper","callNotifySuccessInHost","notifyAppLoadedHelper","notifyExpectedFailureHelper","notifyFailureHelper","notifySuccessHelper","openLinkHelper","registerOnThemeChangeHandlerHelper"],"sources":["/Users/tobitowoju/clarivue-addon/clarivue-addon/node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/internal/appHelpers.js"],"sourcesContent":["import{__awaiter as i}from\"../../../../node_modules/.pnpm/@rollup_plugin-typescript@11.1.6_rollup@4.24.4_tslib@2.6.3_typescript@4.9.5/node_modules/tslib/tslib.es6.js\";import{sendMessageToParent as e,sendAndHandleStatusAndReason as n,callFunctionInHostAndHandleResponse as t,initializeCommunication as o}from\"./communication.js\";import{errorLibraryNotInitialized as r,defaultSDKVersionForCompatCheck as s}from\"./constants.js\";import{GlobalVars as l}from\"./globalVars.js\";import{registerOnThemeChangeHandler as a,initializeHandlers as p}from\"./handlers.js\";import{ensureInitializeCalled as u,ensureInitialized as m,processAdditionalValidOrigins as c}from\"./internalAPIs.js\";import{getLogger as f}from\"./telemetry.js\";import{isNullOrUndefined as d}from\"./typeCheckUtilities.js\";import{inServerSideRenderingEnvironment as g,runWithTimeout as h,compareSDKVersions as S}from\"./utils.js\";import{Messages as j}from\"../public/app/app.js\";import{FrameContexts as v}from\"../public/constants.js\";import{initialize as w}from\"../public/dialog/dialog.js\";import{initialize as y}from\"../public/menus.js\";import{runtime as z,applyRuntimeConfig as b,generateVersionBasedTeamsRuntimeConfig as P,mapTeamsVersionToSupportedCapabilities as C,versionAndPlatformAgnosticTeamsRuntimeConfig as x}from\"../public/runtime.js\";import{version as D}from\"../public/version.js\";import{SimpleTypeResponseHandler as E}from\"./responseHandler.js\";import{initialize as V}from\"../public/pages/config.js\";const K=f(\"app\");function _(i,e){if(g()){return K.extend(\"initialize\")(\"window object undefined at initialization\"),Promise.resolve()}return h((()=>function(i,e){return new Promise((n=>{l.initializeCalled||(l.initializeCalled=!0,p(),l.initializePromise=o(e,i).then((({context:i,clientType:e,runtimeConfig:n,clientSupportedSDKVersion:t=s})=>{l.frameContext=i,l.hostClientType=e,l.clientSupportedSDKVersion=t;try{H(\"Parsing %s\",n);const i=JSON.parse(n);if(H(\"Checking if %o is a valid runtime object\",null!=i?i:\"null\"),!i||!i.apiVersion)throw new Error(\"Received runtime config is invalid\");n&&b(i)}catch(i){if(!(i instanceof SyntaxError))throw i;try{H(\"Attempting to parse %s as an SDK version\",n),isNaN(S(n,s))||(l.clientSupportedSDKVersion=n);const i=JSON.parse(t);if(H(\"givenRuntimeConfig parsed to %o\",null!=i?i:\"null\"),!i)throw new Error(\"givenRuntimeConfig string was successfully parsed. However, it parsed to value of null\");b(i)}catch(i){if(!(i instanceof SyntaxError))throw i;b(P(l.clientSupportedSDKVersion,x,C))}}l.initializeCompleted=!0})),y(),V(),w()),Array.isArray(e)&&c(e),void 0!==l.initializePromise?n(l.initializePromise):H(\"GlobalVars.initializePromise is unexpectedly undefined\")}))}(i,e)),6e4,new Error(\"SDK initialization timed out.\"))}function k(i){e(i,j.AppLoaded,[D])}function A(i,n){e(i,j.ExpectedFailure,[n.reason,n.message])}function F(i,n){e(i,j.Failure,[n.reason,n.message])}function N(e){return i(this,void 0,void 0,(function*(){if(l.initializeCompleted)return R(e);if(!l.initializePromise)throw new Error(r);return l.initializePromise.then((()=>R(e)))}))}function R(n){return i(this,void 0,void 0,(function*(){return m(z)&&(null===(i=z.supports.app)||void 0===i?void 0:i.notifySuccessResponse)?t(j.Success,[D],new E,n).then((()=>({hasFinishedSuccessfully:!0}))):(e(n,j.Success,[D]),{hasFinishedSuccessfully:\"unknown\"});var i}))}const H=K.extend(\"initializeHelper\");function J(i,e){!d(e)&&u(),a(i,e)}function L(i,e){return new Promise((t=>{m(z,v.content,v.sidePanel,v.settings,v.task,v.stage,v.meetingStage),t(n(i,\"executeDeepLink\",e))}))}export{_ as appInitializeHelper,R as callNotifySuccessInHost,k as notifyAppLoadedHelper,A as notifyExpectedFailureHelper,F as notifyFailureHelper,N as notifySuccessHelper,L as openLinkHelper,J as registerOnThemeChangeHandlerHelper};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}