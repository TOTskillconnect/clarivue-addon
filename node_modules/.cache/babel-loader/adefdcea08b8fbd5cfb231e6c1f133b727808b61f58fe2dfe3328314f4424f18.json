{"ast":null,"code":"import { __awaiter as i } from \"../../../../../node_modules/.pnpm/@rollup_plugin-typescript@11.1.6_rollup@4.24.4_tslib@2.6.3_typescript@4.9.5/node_modules/tslib/tslib.es6.js\";\nimport { sendAndUnwrap as o } from \"../../internal/communication.js\";\nimport { ensureInitialized as t } from \"../../internal/internalAPIs.js\";\nimport { getLogger as r, getApiVersionTag as e } from \"../../internal/telemetry.js\";\nimport { errorNotSupportedOnPlatform as n } from \"../../public/constants.js\";\nimport { isSdkError as l } from \"../../public/interfaces.js\";\nimport { runtime as s } from \"../../public/runtime.js\";\nconst a = r(\"copilot\");\nfunction p() {\n  var i, o;\n  return t(s) && (!!(null === (i = s.hostVersionsInfo) || void 0 === i ? void 0 : i.appEligibilityInformation) || !!(null === (o = s.supports.copilot) || void 0 === o ? void 0 : o.eligibility));\n}\nfunction u(r) {\n  var u, m;\n  return i(this, void 0, void 0, function* () {\n    if (t(s), !p()) throw new Error(\"Error code: \".concat(n.errorCode, \", message: Not supported on platform\"));\n    if ((null === (u = s.hostVersionsInfo) || void 0 === u ? void 0 : u.appEligibilityInformation) && !r) return a(\"Eligibility information is already available on runtime.\"), s.hostVersionsInfo.appEligibilityInformation;\n    a(\"Eligibility information is not available on runtime. Requesting from host.\");\n    const i = yield o(e(\"v2\", \"copilot.eligibility.getEligibilityInfo\"), \"copilot.eligibility.getEligibilityInfo\", r);\n    if (l(i)) throw new Error(\"Error code: \".concat(i.errorCode, \", message: \").concat(null !== (m = i.message) && void 0 !== m ? m : \"Failed to get eligibility information from the host.\"));\n    if (!function (i) {\n      if (void 0 === i.ageGroup || void 0 === i.cohort || void 0 === i.userClassification || void 0 === i.isCopilotEligible || void 0 === i.isCopilotEnabledRegion || void 0 === i.isOptedOutByAdmin || i.featureSet && (void 0 === i.featureSet.serverFeatures || void 0 === i.featureSet.uxFeatures)) return !1;\n      return !0;\n    }(i)) throw new Error(\"Error deserializing eligibility information\");\n    return i;\n  });\n}\nexport { u as getEligibilityInfo, p as isSupported };","map":{"version":3,"names":["__awaiter","i","sendAndUnwrap","o","ensureInitialized","t","getLogger","r","getApiVersionTag","e","errorNotSupportedOnPlatform","n","isSdkError","l","runtime","s","a","p","hostVersionsInfo","appEligibilityInformation","supports","copilot","eligibility","u","m","Error","concat","errorCode","message","ageGroup","cohort","userClassification","isCopilotEligible","isCopilotEnabledRegion","isOptedOutByAdmin","featureSet","serverFeatures","uxFeatures","getEligibilityInfo","isSupported"],"sources":["/Users/tobitowoju/clarivue-addon/clarivue-addon/node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/private/copilot/eligibility.js"],"sourcesContent":["import{__awaiter as i}from\"../../../../../node_modules/.pnpm/@rollup_plugin-typescript@11.1.6_rollup@4.24.4_tslib@2.6.3_typescript@4.9.5/node_modules/tslib/tslib.es6.js\";import{sendAndUnwrap as o}from\"../../internal/communication.js\";import{ensureInitialized as t}from\"../../internal/internalAPIs.js\";import{getLogger as r,getApiVersionTag as e}from\"../../internal/telemetry.js\";import{errorNotSupportedOnPlatform as n}from\"../../public/constants.js\";import{isSdkError as l}from\"../../public/interfaces.js\";import{runtime as s}from\"../../public/runtime.js\";const a=r(\"copilot\");function p(){var i,o;return t(s)&&(!!(null===(i=s.hostVersionsInfo)||void 0===i?void 0:i.appEligibilityInformation)||!!(null===(o=s.supports.copilot)||void 0===o?void 0:o.eligibility))}function u(r){var u,m;return i(this,void 0,void 0,(function*(){if(t(s),!p())throw new Error(`Error code: ${n.errorCode}, message: Not supported on platform`);if((null===(u=s.hostVersionsInfo)||void 0===u?void 0:u.appEligibilityInformation)&&!r)return a(\"Eligibility information is already available on runtime.\"),s.hostVersionsInfo.appEligibilityInformation;a(\"Eligibility information is not available on runtime. Requesting from host.\");const i=yield o(e(\"v2\",\"copilot.eligibility.getEligibilityInfo\"),\"copilot.eligibility.getEligibilityInfo\",r);if(l(i))throw new Error(`Error code: ${i.errorCode}, message: ${null!==(m=i.message)&&void 0!==m?m:\"Failed to get eligibility information from the host.\"}`);if(!function(i){if(void 0===i.ageGroup||void 0===i.cohort||void 0===i.userClassification||void 0===i.isCopilotEligible||void 0===i.isCopilotEnabledRegion||void 0===i.isOptedOutByAdmin||i.featureSet&&(void 0===i.featureSet.serverFeatures||void 0===i.featureSet.uxFeatures))return!1;return!0}(i))throw new Error(\"Error deserializing eligibility information\");return i}))}export{u as getEligibilityInfo,p as isSupported};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}